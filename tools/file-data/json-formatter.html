<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSON Formatter & Validator | Neelakandan</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Existing styles... */
        *,
        *::before,
        *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        :root {
            --bg-dark: #0c0c0c;
            --bg-surface: #161616;
            --bg-card: #1f1f1f;
            --accent: #a855f7;
            --accent-glow: rgba(168, 85, 247, 0.25);
            --text-primary: #fff;
            --text-secondary: #a1a1aa;
            --text-muted: #71717a;
            --border: rgba(255, 255, 255, 0.08);
            --success: #22c55e;
            --error: #ef4444;
            --radius: 16px;
            --radius-sm: 10px;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            min-height: 100vh;
        }

        .app {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            padding: 0.875rem 1.5rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid var(--border);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.625rem;
            text-decoration: none;
            color: var(--text-primary);
        }

        .logo-icon {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, var(--accent), #ec4899);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
        }

        .logo-text {
            font-weight: 700;
            font-size: 1rem;
        }

        .back-link {
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.8125rem;
            padding: 0.5rem 0.875rem;
            border-radius: var(--radius-sm);
            border: 1px solid var(--border);
            transition: all 0.2s;
        }

        .back-link:hover {
            background: var(--bg-card);
            color: var(--text-primary);
        }

        .main {
            flex: 1;
            display: flex;
            align-items: stretch;
            justify-content: center;
            padding: 2rem;
        }

        .tool-container {
            background: var(--bg-surface);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 2rem;
            width: 100%;
            max-width: 1200px;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .tool-header {
            text-align: center;
            margin-bottom: 1rem;
        }

        .tool-header h1 {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }

        .tool-header p {
            color: var(--text-secondary);
            font-size: 0.875rem;
        }

        .editors-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            flex: 1;
            min-height: 500px;
        }

        .editor-box {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            position: relative;
        }

        .editor-label {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-muted);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .text-area {
            width: 100%;
            height: 100%;
            padding: 1rem;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            color: var(--text-primary);
            font-size: 0.9rem;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', monospace;
            resize: none;
            line-height: 1.5;
        }

        .text-area:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px var(--accent-glow);
        }

        .actions-bar {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
            justify-content: center;
            padding: 1rem 0;
            border-top: 1px solid var(--border);
            border-bottom: 1px solid var(--border);
        }

        .btn {
            padding: 0.6rem 1.25rem;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            color: var(--text-primary);
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn:hover {
            border-color: var(--accent);
            background: linear-gradient(135deg, rgba(168, 85, 247, 0.1), rgba(236, 72, 153, 0.1));
        }

        .btn.primary {
            background: linear-gradient(135deg, var(--accent), #ec4899);
            border: none;
            color: white;
        }

        .btn.primary:hover {
            opacity: 0.9;
            box-shadow: 0 4px 12px var(--accent-glow);
        }

        .btn.active {
            background: var(--accent);
            color: white;
            border-color: var(--accent);
        }

        /* Message/Status */
        .status-msg {
            text-align: center;
            font-size: 0.875rem;
            min-height: 1.5em;
        }

        .status-success {
            color: var(--success);
        }

        .status-error {
            color: var(--error);
        }

        /* Tree View Styles */
        .json-tree-container {
            width: 100%;
            height: 100%;
            padding: 1rem;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            color: var(--text-primary);
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', monospace;
            overflow: auto;
            font-size: 0.9rem;
            line-height: 1.5;
            display: none;
            /* Hidden by default */
        }

        .json-tree-container.visible {
            display: block;
        }

        .json-node {
            margin-left: 1.5rem;
        }

        .json-key {
            color: #9cdcfe;
            margin-right: 5px;
        }

        .json-string {
            color: #ce9178;
        }

        .json-number {
            color: #b5cea8;
        }

        .json-boolean {
            color: #569cd6;
        }

        .json-null {
            color: #569cd6;
        }

        .json-toggler {
            cursor: pointer;
            user-select: none;
            display: inline-block;
            width: 1rem;
            margin-left: -1rem;
            color: var(--text-muted);
            transition: transform 0.1s;
        }

        .json-toggler::before {
            content: '▼';
            font-size: 0.7rem;
            display: inline-block;
        }

        .json-collapsed>.json-toggler::before {
            transform: rotate(-90deg);
        }

        .json-collapsed>.json-children {
            display: none;
        }

        .view-toggles {
            display: flex;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            padding: 2px;
            margin-left: auto;
        }

        .view-toggle-btn {
            padding: 2px 8px;
            font-size: 0.75rem;
            cursor: pointer;
            border-radius: 6px;
            border: none;
            background: transparent;
            color: var(--text-secondary);
        }

        .view-toggle-btn.active {
            background: var(--bg-surface);
            color: var(--text-primary);
            font-weight: 600;
        }

        @media (max-width: 768px) {
            .editors-container {
                grid-template-columns: 1fr;
            }

            .tool-container {
                padding: 1rem;
            }
        }
    </style>
</head>

<body>
    <div class="app">
        <header class="header">
            <a href="#" class="logo">
                <div class="logo-icon">{ }</div><span class="logo-text">JSON Tools</span>
            </a>
            <a href="../../tools/#file-data" class="back-link">← Back</a>
        </header>
        <main class="main">
            <div class="tool-container">
                <div class="tool-header">
                    <h1>JSON Formatter & Validator</h1>
                    <p>Format, validate, and minify your JSON data with interactive Tree View</p>
                </div>

                <div class="actions-bar">
                    <button class="btn primary" onclick="formatJSON()">Format / Beautify</button>
                    <button class="btn" onclick="minifyJSON()">Minify / Compact</button>
                    <button class="btn" onclick="validateJSON()">Validate</button>
                    <button class="btn" onclick="copyOutput()">Copy Result</button>
                    <button class="btn" onclick="clearAll()">Clear</button>
                </div>

                <p id="status-msg" class="status-msg"></p>

                <div class="editors-container">
                    <div class="editor-box">
                        <div class="editor-label">Input JSON <button class="btn"
                                style="padding: 2px 8px; font-size: 10px;" onclick="loadSample()">Load Sample</button>
                        </div>
                        <textarea id="input-json" class="text-area" placeholder="Paste your JSON here..."></textarea>
                    </div>
                    <div class="editor-box">
                        <div class="editor-label">
                            Output
                            <div class="view-toggles">
                                <button class="view-toggle-btn active" id="btn-text"
                                    onclick="switchView('text')">Text</button>
                                <button class="view-toggle-btn" id="btn-tree" onclick="switchView('tree')">Tree</button>
                            </div>
                        </div>

                        <!-- Text Output -->
                        <textarea id="output-json" class="text-area" readonly
                            placeholder="Result will appear here..."></textarea>

                        <!-- Tree Output -->
                        <div id="output-tree" class="json-tree-container"></div>
                    </div>
                </div>
            </div>
        </main>
    </div>
    <script>
        const input = document.getElementById('input-json');
        const outputText = document.getElementById('output-json');
        const outputTree = document.getElementById('output-tree');
        const status = document.getElementById('status-msg');

        let currentView = 'text'; // 'text' or 'tree'
        let currentObj = null;

        function showStatus(msg, type) {
            status.textContent = msg;
            status.className = 'status-msg ' + (type === 'error' ? 'status-error' : 'status-success');
            setTimeout(() => { status.textContent = ''; status.className = 'status-msg'; }, 3000);
        }

        function switchView(view) {
            currentView = view;

            // Toggle classes for buttons
            document.getElementById('btn-text').classList.toggle('active', view === 'text');
            document.getElementById('btn-tree').classList.toggle('active', view === 'tree');

            // Toggle visibility
            if (view === 'text') {
                outputText.style.display = 'block';
                outputTree.classList.remove('visible');
            } else {
                outputText.style.display = 'none';
                outputTree.classList.add('visible');
                // If we have an object but empty tree, render it
                if (currentObj && outputTree.innerHTML === '') {
                    renderTree(currentObj);
                } else if (!currentObj && input.value.trim()) {
                    // Try to parse input if switch happens without formatting first
                    try {
                        currentObj = JSON.parse(input.value);
                        renderTree(currentObj);
                    } catch (e) {
                        outputTree.innerHTML = '<div style="color:var(--error); padding:1rem;">Invalid JSON</div>';
                    }
                }
            }
        }

        function formatJSON() {
            try {
                const val = input.value;
                if (!val.trim()) return;
                currentObj = JSON.parse(val);

                // Update Text View
                outputText.value = JSON.stringify(currentObj, null, 4);

                // Update Tree View
                renderTree(currentObj);

                showStatus('JSON formatted successfully', 'success');
            } catch (e) {
                showStatus('Invalid JSON: ' + e.message, 'error');
            }
        }

        function minifyJSON() {
            try {
                const val = input.value;
                if (!val.trim()) return;
                currentObj = JSON.parse(val);

                // Update Text View
                outputText.value = JSON.stringify(currentObj);

                // Switch to text view for minify as tree is inherently expanded/structured
                if (currentView === 'tree') switchView('text');

                showStatus('JSON minified successfully', 'success');
            } catch (e) {
                showStatus('Invalid JSON: ' + e.message, 'error');
            }
        }

        function validateJSON() {
            try {
                const val = input.value;
                if (!val.trim()) { showStatus('Please enter JSON to validate', 'error'); return; }
                currentObj = JSON.parse(val);
                showStatus('Valid JSON', 'success');
            } catch (e) {
                showStatus('Invalid JSON: ' + e.message, 'error');
            }
        }

        function copyOutput() {
            let content = '';
            if (currentView === 'text') {
                content = outputText.value;
            } else {
                // If in tree view, copy pretty printed version of current object
                content = currentObj ? JSON.stringify(currentObj, null, 4) : '';
            }

            if (!content) return;
            navigator.clipboard.writeText(content);
            showStatus('Copied to clipboard', 'success');
        }

        function clearAll() {
            input.value = '';
            outputText.value = '';
            outputTree.innerHTML = '';
            status.textContent = '';
            currentObj = null;
        }

        function loadSample() {
            input.value = '{\n    "name": "Neelakandan",\n    "role": "Developer",\n    "skills": ["HTML", "CSS", "JS"],\n    "projects": [\n        {"name": "Tools", "status": "Active"},\n        {"name": "Portfolio", "status": "Completed"}\n    ],\n    "active": true,\n    "meta": null\n}';
            formatJSON(); // Auto format on load
        }

        // Tree View Logic
        function renderTree(obj) {
            outputTree.innerHTML = '';
            outputTree.appendChild(createTreeNode('root', obj, true));
        }

        function createTreeNode(key, value, isRoot = false) {
            const node = document.createElement('div');
            node.className = 'json-node';

            if (isRoot) node.style.marginLeft = '0';

            const type = value === null ? 'null' : typeof value;

            if (type === 'object' && value !== null) {
                const isArray = Array.isArray(value);
                const isEmpty = isArray ? value.length === 0 : Object.keys(value).length === 0;

                // Toggler
                if (!isEmpty) {
                    const toggler = document.createElement('span');
                    toggler.className = 'json-toggler';
                    toggler.onclick = function (e) {
                        e.stopPropagation();
                        node.classList.toggle('json-collapsed');
                    };
                    node.appendChild(toggler);
                }

                // Key
                if (!isRoot && key !== undefined) {
                    const keySpan = document.createElement('span');
                    keySpan.className = 'json-key';
                    keySpan.textContent = `"${key}":`;
                    node.appendChild(keySpan);
                }

                // Opening Brace/Bracket
                const openSpan = document.createElement('span');
                openSpan.textContent = isArray ? '[' : '{';
                openSpan.style.color = '#ffd700'; // Gold color for brackets
                node.appendChild(openSpan);

                if (!isEmpty) {
                    // Children Container
                    const childrenDiv = document.createElement('div');
                    childrenDiv.className = 'json-children';

                    if (isArray) {
                        value.forEach((item, index) => {
                            childrenDiv.appendChild(createTreeNode(undefined, item));
                        });
                    } else {
                        Object.keys(value).forEach(k => {
                            childrenDiv.appendChild(createTreeNode(k, value[k]));
                        });
                    }
                    node.appendChild(childrenDiv);
                }

                // Closing Brace/Bracket
                const closeSpan = document.createElement('span');
                closeSpan.textContent = isArray ? ']' : '}';
                closeSpan.style.color = '#ffd700';
                node.appendChild(closeSpan);

                // Comma (if needed, simplified logic here, strict comma not critical for view)
            } else {
                // Primitive
                // Key
                if (!isRoot && key !== undefined) {
                    const keySpan = document.createElement('span');
                    keySpan.className = 'json-key';
                    keySpan.textContent = `"${key}":`;
                    node.appendChild(keySpan);
                }

                const valSpan = document.createElement('span');
                valSpan.className = `json-${type}`;

                if (type === 'string') {
                    valSpan.textContent = `"${value}"`;
                } else {
                    valSpan.textContent = String(value);
                }

                node.appendChild(valSpan);
            }

            return node;
        }
    </script>
</body>

</html>